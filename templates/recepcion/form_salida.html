{% extends "base.html" %}
{% from "_form_helpers.html" import render_field %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">{{ title }}</h1>
</div>

<div class="row">
    <div class="col-lg-6">
        <!-- Tarjeta de Resumen de la Carga -->
        <div class="card shadow-sm mb-4">
            <div class="card-header"><h5 class="mb-0">Resumen de la Entrada</h5></div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Productor:</strong> {{ carga.productor.nombre_completo }}</li>
                    <li class="list-group-item"><strong>Placa Vehículo:</strong> {{ carga.vehiculo.placa }}</li>
                    
                    <!-- LÍNEA CORREGIDA Y MEJORADA -->
                    {% if carga.placa_acoplado %}
                    <li class="list-group-item"><strong>Placa Acoplado:</strong> {{ carga.placa_acoplado }}</li>
                    {% endif %}
                    
                    <li class="list-group-item"><strong>Peso Bruto Registrado:</strong> <span class="fw-bold">{{ "%.2f"|format(carga.peso_bruto) }} kg</span></li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <!-- Formulario para registrar la salida -->
        <div class="card shadow-sm mb-4">
            <div class="card-header"><h5 class="mb-0">Registrar Peso de Salida (Tara)</h5></div>
            <div class="card-body">
                <form method="POST" novalidate>
                    {{ form.hidden_tag() }}
                    {{ render_field(form.peso_tara, class="form-control form-control-lg", placeholder="Automático de báscula") }}
                    <div class="d-grid gap-2 mt-3">
                        {{ form.submit(class="btn btn-success btn-lg") }}
                        <a href="{{ url_for('recepcion.listar_cargas') }}" class="btn btn-secondary">Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}